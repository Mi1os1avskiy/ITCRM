{% extends 'base.html.twig' %}

{% block title %}{{ title }}{% endblock %}

{% block main %}

	<support-module inline-template>

		<main class="mb-24">

		{% block content %}

			{% block header %}

				<div class="bg-gray-50 px-8">
					<div class="flex py-4 justify-between">
						<div class="flex items-center font-semibold text-gray-900 text-lg">
							{{ title }}
						</div>
						<div class="flex items-center space-x-2 ">
							<div class="relative flex items-center border border-gray-300 rounded-md">
								<button type="button" class="p-2 rounded-l-md hover:bg-gray-100">
									<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M15.3125 11.4236C14.5263 14.3576 11.5104 16.0988 8.57636 15.3127C7.60734 15.053 6.7703 14.5514 6.11058 13.8904L5.79904 13.5789L8.23227 13.5784C8.64649 13.5784 8.98221 13.2425 8.98214 12.8283C8.98206 12.4141 8.64622 12.0784 8.232 12.0784L3.98857 12.0792C3.78965 12.0792 3.5989 12.1583 3.45827 12.299C3.31764 12.4397 3.23866 12.6304 3.23871 12.8294L3.2396 17.0712C3.23968 17.4854 3.57554 17.8211 3.98975 17.821C4.40397 17.821 4.73968 17.4851 4.7396 17.0709L4.73909 14.6402L5.04894 14.9501C5.88997 15.7926 6.95765 16.4318 8.18814 16.7615C11.9224 17.7621 15.7608 15.5461 16.7613 11.8118C16.8686 11.4117 16.6311 11.0004 16.231 10.8932C15.8309 10.786 15.4197 11.0235 15.3125 11.4236ZM16.5414 7.70119C16.682 7.56051 16.761 7.36971 16.761 7.17078L16.7603 2.92883C16.7602 2.51462 16.4244 2.17888 16.0102 2.17895C15.596 2.17902 15.2602 2.51486 15.2603 2.92907L15.2607 5.35994L14.9509 5.05013C14.1099 4.20771 13.042 3.56826 11.8116 3.23859C8.07734 2.23799 4.23898 4.45407 3.23839 8.18833C3.13118 8.58843 3.36862 8.99969 3.76872 9.10689C4.16882 9.2141 4.58007 8.97666 4.68728 8.57656C5.47346 5.6425 8.48931 3.90129 11.4234 4.68747C12.3924 4.94713 13.2295 5.44881 13.8892 6.10979L14.2003 6.4209L11.7684 6.4209C11.3542 6.4209 11.0184 6.75669 11.0184 7.1709C11.0184 7.58511 11.3542 7.9209 11.7684 7.9209H16.011C16.2099 7.9209 16.4007 7.84186 16.5414 7.70119Z" fill="#6B7280"/>
									</svg>
								</button>
								<div class="w-16 py-2 text-sm font-medium text-gray-700 cursor-default">10:05</div>
								<button type="button" class="-ml-px p-2 border-l border-gray-300 rounded-r-md hover:bg-gray-100" aria-expanded="false" aria-expanded-autohide>
									<svg class="pointer-events-none" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.23017 7.20938C5.52875 6.92228 6.00353 6.93159 6.29063 7.23017L10 11.1679L13.7094 7.23017C13.9965 6.93159 14.4713 6.92228 14.7698 7.20938C15.0684 7.49647 15.0777 7.97125 14.7906 8.26983L10.5406 12.7698C10.3992 12.9169 10.204 13 10 13C9.79599 13 9.60078 12.9169 9.45938 12.7698L5.20938 8.26983C4.92228 7.97125 4.93159 7.49647 5.23017 7.20938Z" fill="#6B7280"/>
									</svg>
								</button>
								<ul class="absolute z-10 w-[136px] top-10 rounded-md bg-white text-sm text-gray-700 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none">
									<li class="hover:bg-gray-50">
										<button type="button" class="w-full py-3 px-4 text-left">30 секунд</button>
									</li>
									<li class="hover:bg-gray-50">
										<button type="button" class="w-full py-3 px-4 text-left">1 минута</button>
									</li>
									<li class="hover:bg-gray-50">
										<button type="button" class="w-full py-3 px-4 text-left">5 минут</button>
									</li>
									<li class="hover:bg-gray-50">
										<button type="button" class="w-full py-3 px-4 text-left">10 минут</button>
									</li><li class="hover:bg-gray-50">
										<button type="button" class="w-full py-3 px-4 text-left">15 минут</button>
									</li>
								</ul>
							</div>
							<div class="flex items-center">
								<div class="flex-shrink-0">
									<a href="{{ path('new_ticket') }}" class="relative inline-flex items-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700">
										<svg class="-ml-1 mr-2 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
											<path d="M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"/>
										</svg>
										<span>Добавить</span>
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>

			{% endblock %}

			<support-settings inline-template>

				<div class="mt-4">

				{% block control %}

					<div class="flex mb-4 px-8 justify-between">
						<div class="flex space-x-4 items-center">
							<div class="relative flex flex-shrink-0">
								<button type="button" class="flex space-x-1 rounded-md border border-gray-300 bg-white py-2 px-4 text-left shadow-sm hover:bg-gray-50 text-sm" aria-expanded="false" aria-expanded-autohide>
									<span class="pointer-events-none">Действия</span>
									<span class="pointer-events-none flex items-center">
	                                    <svg class="h-5 w-5 text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
	                                        <path fill-rule="evenodd" d="M10 3a.75.75 0 01.55.24l3.25 3.5a.75.75 0 11-1.1 1.02L10 4.852 7.3 7.76a.75.75 0 01-1.1-1.02l3.25-3.5A.75.75 0 0110 3zm-3.76 9.2a.75.75 0 011.06.04l2.7 2.908 2.7-2.908a.75.75 0 111.1 1.02l-3.25 3.5a.75.75 0 01-1.1 0l-3.25-3.5a.75.75 0 01.04-1.06z" clip-rule="evenodd" />
	                                    </svg>
	                                </span>
								</button>
								<ul class="absolute z-10 w-56 top-10 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none text-sm">
									<li class="text-gray-700">
										<button @click="supportTicketsClose()" type="button" class="w-full py-3 px-4 hover:bg-gray-50">
											<span class="pr-16 whitespace-nowrap">Закрыть тикеты</span>
										</button>
									</li>
									<li class="text-gray-700">
										<button @click="supportTicketsDelete()" type="button" class="w-full py-3 px-4 hover:bg-gray-50">
											<span class="pr-16 whitespace-nowrap">Удалить тикеты</span>
										</button>
									</li>
								</ul>
							</div>
							<nav class="flex items-center text-sm text-gray-700">
								<a href="#" class="py-2 px-4 border border-gray-300 rounded-l-md hover:bg-gray-50">Ожидают ответа</a>
								<a href="#" class="-ml-px py-2 px-4 border border-gray-300 hover:bg-gray-50">Все активные</a>

								<div class="relative">
									<button type="button" class="-ml-px p-2 border border-gray-300 rounded-r-md hover:bg-gray-50" aria-expanded="false" aria-expanded-autohide>
										<svg class="pointer-events-none" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
											<path fill-rule="evenodd" clip-rule="evenodd" d="M5.23017 7.20938C5.52875 6.92228 6.00353 6.93159 6.29063 7.23017L10 11.1679L13.7094 7.23017C13.9965 6.93159 14.4713 6.92228 14.7698 7.20938C15.0684 7.49647 15.0777 7.97125 14.7906 8.26983L10.5406 12.7698C10.3992 12.9169 10.204 13 10 13C9.79599 13 9.60078 12.9169 9.45938 12.7698L5.20938 8.26983C4.92228 7.97125 4.93159 7.49647 5.23017 7.20938Z" fill="#6B7280"/>
										</svg>
									</button>
									<ul class="absolute z-10 top-10 right-0 py-1 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none text-sm">
										<li class="group border-b border-gray-100">
											<a href="{{ path('support_tickets') }}" class="flex w-full py-3 px-5 hover:bg-indigo-700">
												<span class="text-gray-700 whitespace-nowrap group-hover:text-gray-50">Все тикеты</span>
											</a>
										</li>
										{% for val, css in ticket_statuses %}
											<li class="group">
												<a href="{{ path('support_tickets', { sort:val }) }}" class="flex items-center w-full py-3 px-5 space-x-4 hover:bg-indigo-700">
													<div class="h-2.5 w-2.5 rounded-full bg-{{ css }}-400"></div>
													<span class="text-gray-700 {% if getGet() == val %} text-red-500 {% endif %} whitespace-nowrap group-hover:text-gray-50">{{ val }}</span>
												</a>
											</li>
										{% endfor %}
									</ul>
								</div>
							</nav>
						</div>

						<div class="flex items-center space-x-2">
							<div class="w-[180px] relative">
								<div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
									<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M9 3.5C5.96243 3.5 3.5 5.96243 3.5 9C3.5 12.0376 5.96243 14.5 9 14.5C10.519 14.5 11.893 13.8852 12.8891 12.8891C13.8852 11.893 14.5 10.519 14.5 9C14.5 5.96243 12.0376 3.5 9 3.5ZM2 9C2 5.13401 5.13401 2 9 2C12.866 2 16 5.13401 16 9C16 10.6625 15.4197 12.1906 14.4517 13.3911L17.7803 16.7197C18.0732 17.0126 18.0732 17.4874 17.7803 17.7803C17.4874 18.0732 17.0126 18.0732 16.7197 17.7803L13.3911 14.4517C12.1906 15.4197 10.6625 16 9 16C5.13401 16 2 12.866 2 9Z" fill="#6B7280"/>
									</svg>
								</div>
								<input name="search" class="block w-full rounded-md border border-gray-300 bg-white py-2 pl-10 pr-3 leading-5 placeholder-gray-400 focus:border-indigo-500 focus:placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-indigo-500 sm:text-sm" placeholder="Поиск" type="search">
							</div>
							<div class="flex items-center">
								<button @click="supportFilters()" type="button" class="inline-flex items-center -ml-px rounded-{% if getGet() %}r-{% endif %}md border border-gray-300 pl-3 pr-4 py-2 shadow-sm hover:bg-gray-50">
									<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.47102 3.46746C6.27039 3.15991 8.11739 3 10 3C11.8826 3 13.7296 3.15991 15.529 3.46746C15.8007 3.51389 16 3.75747 16 4.04302V5.8223C16 6.28643 15.8222 6.73155 15.5057 7.05974L11.9943 10.7013C11.6778 11.0295 11.5 11.4746 11.5 11.9387V14.3004C11.5 14.832 11.267 15.3348 10.8667 15.6669L9.41389 16.8722C9.24505 17.0122 9.01372 17.0396 8.81883 16.9424C8.62394 16.8453 8.5 16.6409 8.5 16.4167V11.9387C8.5 11.4746 8.32221 11.0295 8.00574 10.7013L4.49426 7.05974C4.17779 6.73155 4 6.28643 4 5.8223V4.04302C4 3.75747 4.19934 3.51389 4.47102 3.46746Z" fill="#6B7280"/>
									</svg>
									<span class="ml-2 text-sm text-gray-700">Фильтры</span>
								</button>
							</div>
						</div>
					</div>

				{% endblock %}

				{% block table %}

					<div class="px-8">
						<div class="mt-2 flex flex-col">
							<div class="min-w-full overflow-hidden overflow-x-auto align-middle border rounded-lg">

								<table class="min-w-full divide-y divide-gray-200">
									<thead>
									<tr class="bg-gray-50 border-b border-gray-300 text-gray-900 text-sm font-medium">
										<th class="inline-block w-10"></th>
										<th class="min-w-[293px] px-3 py-3 text-left font-medium whitespace-nowrap">ID - Тема</th>
										<th class="w-[184px] px-3 py-3 text-left font-medium">Статус</th>
										<th class="w-[100px] px-3 py-3 text-left font-medium">Приоритет</th>
										<th class="w-[184px] px-3 py-3 text-left font-medium">Департамент</th>
										<th class="w-[180px] px-3 py-3 text-left font-medium">Клиент</th>
										<th class="w-[100px] pl-3 pr-6 py-3 text-left font-medium whitespace-nowrap">Ответ</th>
									</tr>
									</thead>

									<tbody class="divide-y divide-gray-200 bg-white">

									{% for ticket in tickets %}

										{% set table_body %}

											<tr>
												<td class="w-10 relative pl-6">
													<input type="checkbox" class="absolute -mt-2 h-4 w-4 rounded border-gray-300 focus:ring-indigo-500">
												</td>
												<td class="min-w-[293px] px-3 py-4 text-sm text-gray-900">
													<a href="{{ path('support_ticket_answer') }}" class="font-medium hover:text-indigo-700">
														<p class="line-clamp-1 overflow-hidden" title="#{{ ticket.id }} - {{ ticket.theme }}">#{{ ticket.id }} - {{ ticket.theme }}</p>
													</a>
												</td>
												<td class="whitespace-nowrap px-3 py-4">
													{% for val, css in ticket_statuses %}
														{% if ticket.status == val %}
															<span class="inline-block align-middle px-2.5 py-0.5 rounded-full text-xs font-medium bg-{{ css }}-{% if css == 'orange' %}200{% else %}100{% endif %} text-{{ css }}-800 cursor-default">{{ val }}</span>
														{% endif %}
													{% endfor %}
												</td>
												<td class="whitespace-nowrap px-3 py-4">
													{% if ticket.priority == 3 %}
														<div class="h-0.5 w-2.5 rounded bg-green-400"></div>
													{% elseif ticket.priority == 2 %}
														<div class="h-0.5 w-2.5 rounded bg-orange-400"></div>
														<div class="mt-0.5 h-0.5 w-2.5 rounded bg-orange-400"></div>
													{% elseif ticket.priority == 1 %}
														<div class="h-0.5 w-2.5 rounded bg-red-400"></div>
														<div class="mt-0.5 h-0.5 w-2.5 rounded bg-red-400"></div>
														<div class="mt-0.5 h-0.5 w-2.5 rounded bg-red-400"></div>
													{% endif %}
												</td>
												<td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500 cursor-default">
													<p>{{ ticket.dept }}</p>
												</td>
												<td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500 cursor-default">
													<p class="truncate w-36" title="{{ ticket.client }}">{{ ticket.client }}</p>
												</td>
												<td class="whitespace-nowrap pl-3 pr-6 py-4 text-sm text-gray-500 cursor-default">{{ time }}</td>
											</tr>

										{% endset %}

										{% if getGet() %}
											{% if ticket.status == getGet() %}
												{{ table_body }}
											{% endif %}
										{% else %}
											{{ table_body }}
										{% endif %}

									{% endfor %}

									</tbody>
								</table>

								<div class="flex items-center justify-between border-t border-gray-200 bg-gray-50 px-4 py-4 sm:px-6">
									<div class="flex flex-1 justify-between sm:hidden">
										<a href="#" class="relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50">Previous</a>
										<a href="#" class="relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50">Next</a>
									</div>
									<div class="hidden sm:flex sm:flex-1 sm:items-center sm:justify-between">
										<div>
											<nav class="isolate inline-flex -space-x-px rounded-md shadow-sm" aria-label="Pagination">
												<a href="#" class="relative inline-flex items-center rounded-l-md border border-gray-300 bg-white px-2 py-2 text-sm font-medium text-gray-500 hover:bg-gray-50 focus:z-20">
													<span class="sr-only">Previous</span>
													<svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
														<path fill-rule="evenodd" d="M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z" clip-rule="evenodd" />
													</svg>
												</a>
												<a href="#" aria-current="page" class="relative z-10 inline-flex items-center border border-indigo-500 bg-indigo-50 px-4 py-2 text-sm font-medium text-indigo-600 focus:z-20">1</a>
												<a href="#" class="relative inline-flex items-center border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-500 hover:bg-gray-50 focus:z-20">2</a>
												<a href="#" class="relative hidden items-center border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-500 hover:bg-gray-50 focus:z-20 md:inline-flex">3</a>
												<span class="relative inline-flex items-center border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700">...</span>
												<a href="#" class="relative hidden items-center border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-500 hover:bg-gray-50 focus:z-20 md:inline-flex">8</a>
												<a href="#" class="relative inline-flex items-center border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-500 hover:bg-gray-50 focus:z-20">9</a>
												<a href="#" class="relative inline-flex items-center border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-500 hover:bg-gray-50 focus:z-20">10</a>
												<a href="#" class="relative inline-flex items-center rounded-r-md border border-gray-300 bg-white px-2 py-2 text-sm font-medium text-gray-500 hover:bg-gray-50 focus:z-20">
													<span class="sr-only">Next</span>
													<svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
														<path fill-rule="evenodd" d="M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z" clip-rule="evenodd" />
													</svg>
												</a>
											</nav>
										</div>
										<div class="flex items-center space-x-4">
											<p class="text-sm text-gray-500">1 - 8 из 97</p>
											<select class="relative inline-flex items-center rounded-md border border-gray-300 pl-3 pr-9 py-2 text-sm text-gray-900">
												{% for i in 1..4 %}
													<option>{{ i * 25 }}</option>
												{% endfor %}
											</select>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>

				{% endblock %}

				</div>

			</support-settings>

			{% block modals %}
				{% include 'support/modals/support.tickets.close.html.twig' %}
				{% include 'support/modals/support.tickets.delete.html.twig' %}
				{% include 'support/modals/support.tickets.filters.html.twig' %}
			{% endblock %}

		{% endblock %}

		</main>

	</support-module>

{% endblock %}
