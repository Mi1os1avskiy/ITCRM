{% extends 'clients/clients.base.html.twig' %}

{% set currentTab = 'tickets' %}

{% block tickets %}

	<profile-settings inline-template>

		<div>

			<div class="pt-6 px-8 space-y-4">
				<a href="{{ path('new_ticket') }}" class="inline-flex items-center py-2 pl-3 pr-4 space-x-2 rounded-md bg-indigo-600 text-white hover:bg-indigo-700">
					{{ source('assets/images/plus.svg') }}
					<span class="text-sm font-medium">Добавить</span>
				</a>
				<div class="flex items-center justify-between">
					<div class="relative">
						<button type="button" class="flex items-center py-2 pl-4 pr-3 space-x-2 rounded-md ring-1 ring-gray-300 text-sm hover:bg-gray-50" aria-expanded="false" aria-expanded-autohide>
							<span class="text-sm pointer-events-none">Действия</span>
							{{ source('assets/images/arrow.svg') }}
						</button>
						<ul class="dropdown w-40">
							<li>
								<button @click="supportTicketsClose()" type="button" class="w-full py-2 px-4 text-gray-700 text-sm text-left">Закрыть тикеты</button>
							</li>
							<li>
								<button @click="supportTicketsDelete()" type="button" class="w-full py-2 px-4 text-gray-700 text-sm text-left">Удалить тикеты</button>
							</li>
						</ul>
					</div>

					<div class="relative w-60">
						<div class="pointer-events-none absolute inset-y-0 left-3 flex items-center">
							{{ source('assets/images/search.svg') }}
						</div>
						<input class="inputs block w-full py-2 pl-10 pr-3 text-sm" placeholder="Поиск по Теме или ID" type="text">
					</div>
				</div>
			</div>

			{% block table %}

			<div class="py-4 px-8">
				<div class="min-w-full overflow-hidden overflow-x-auto ring-1 ring-gray-200 rounded-t-lg">
					<table class="min-w-full cursor-default">
						<thead>
						<tr class="bg-gray-50 border-b border-gray-300 text-sm">
							<th class="inline-block w-10"></th>
							<th class="p-3 text-left font-medium">ID - Тема</th>
							<th class="w-[184px] p-3 text-left font-medium">Статус</th>
							<th class="w-[100px] p-3 text-left font-medium">Приоритет</th>
							<th class="w-[184px] p-3 text-left font-medium">Департамент</th>
							<th class="w-[100px] pl-3 pr-6 text-left font-medium truncate">Ответ</th>
						</tr>
						</thead>

						<tbody class="divide-y">

						{% for ticket in tickets %}

							<tr>
								<td class="w-10 pl-6">
									<input type="checkbox" class="checkbox flex place-self-center">
								</td>
								<td class="min-w-[300px] py-0 px-3 text-sm">
									<a href="{{ path('support_ticket_answer') }}" class="block py-4 font-medium hover:text-indigo-700" title="{{ ticket.id }} - {{ ticket.theme }}">
										<p class="line-clamp-1 overflow-hidden">{{ ticket.id }} - {{ ticket.theme }}</p>
									</a>
								</td>
								<td class="py-4 px-3">
									{% for val, css in ticket_statuses %}
										{% if ticket.status == val %}
											<div class="w-fit px-2.5 py-0.5 rounded-full text-xs font-medium bg-{{ css }}-{% if css == 'orange' %}200{% else %}100{% endif %} text-{{ css }}-800 whitespace-nowrap">{{ val }}</div>
										{% endif %}
									{% endfor %}
								</td>
								<td class="py-4 px-3 text-sm">
									{% if ticket.priority == 3 %}
										<div class="h-0.5 w-2.5 rounded bg-green-400"></div>
									{% elseif ticket.priority == 2 %}
										<div class="h-0.5 w-2.5 rounded bg-orange-400"></div>
										<div class="mt-0.5 h-0.5 w-2.5 rounded bg-orange-400"></div>
									{% elseif ticket.priority == 1 %}
										<div class="h-0.5 w-2.5 rounded bg-red-400"></div>
										<div class="mt-0.5 h-0.5 w-2.5 rounded bg-red-400"></div>
										<div class="mt-0.5 h-0.5 w-2.5 rounded bg-red-400"></div>
									{% endif %}
								</td>
								<td class="px-3 py-4 text-gray-500 text-sm truncate">{{ ticket.dept }}</td>
								<td class="pl-3 pr-6 py-4 text-sm text-gray-500 text-left truncate">{{ ticket.time }}</td>
							</tr>

						{% endfor %}

						</tbody>
					</table>
				</div>

				{% include 'parts/pagination.html.twig' %}

			</div>

			{% endblock %}

		</div>

	</profile-settings>

{% endblock %}
